{"version":3,"file":"r3f.cjs","sources":["../src/r3f/Atmosphere.tsx","../src/r3f/separateProps.ts","../src/r3f/AerialPerspective.tsx","../node_modules/.pnpm/react-merge-refs@3.0.2_react@19.0.0/node_modules/react-merge-refs/dist/index.js","../src/r3f/LightingMask.tsx","../src/r3f/Sky.tsx","../src/r3f/SkyLight.tsx","../src/r3f/Stars.tsx","../src/r3f/SunLight.tsx","../src/r3f/useAtmosphereTextureProps.ts"],"sourcesContent":null,"names":["AtmosphereContext","createContext","Atmosphere","forwardedRef","texturesProp","ellipsoid","Ellipsoid","correctAltitude","ground","date","children","transientStatesRef","useRef","Vector3","Matrix4","renderer","useThree","gl","loadedTextures","useMemo","PrecomputedTexturesLoader","useEffect","texture","generator","PrecomputedTexturesGenerator","error","textures","context","updateByDate","sunDirection","moonDirection","inertialToECEFMatrix","getECIToECEFRotationMatrix","getSunDirectionECI","getMoonDirectionECI","timestamp","useImperativeHandle","separateProps","params","irradianceTexture","scatteringTexture","transmittanceTexture","singleMieScatteringTexture","higherOrderScatteringTexture","sunAngularRadius","renderTargetCount","others","useLoadSTBNTexture","input","loadedTexture","STBNLoader","AerialPerspective","stbnTextureProp","DEFAULT_STBN_URL","props","transientStates","contextProps","useContext","atmosphereParameters","blendFunction","aerialPerspectiveEffectOptionsDefaults","EffectComposerContext","normalPass","camera","geometryTexture","RenderPass","Texture","effect","AerialPerspectiveEffect","needsSTBN","setNeedsSTBN","useState","useFrame","stbnTexture","jsx","mergeRefsReact16","refs","value","ref","assignRef","mergeRefsReact19","cleanups","cleanup","isCleanup","mergeRefs","version","LightingMask","getRef","useCallback","pass","scene","extend","LightingMaskPass","IrradianceMask","Sky","sun","moon","moonAngularRadius","lunarRadianceScale","groundAlbedo","meshProps","skyMaterialParametersDefaults","material","SkyMaterial","ScreenQuad","SKY_RENDER_ORDER","SkyLight","probe","SkyLightProbe","skyLightProbeParametersDefaults","Stars","dataProp","DEFAULT_STARS_DATA_URL","pointSize","radianceScale","intensity","background","starsMaterialParametersDefaults","data","setData","loader","ArrayBufferLoader","geometry","StarsGeometry","StarsMaterial","_a","jsxs","SunLight","position","light","target","Object3D","SunDirectionalLight","Fragment","sunDirectionalLightParametersDefaults","useAtmosphereTextureProps","url","DEFAULT_PRECOMPUTED_TEXTURES_URL","useLoader"],"mappings":"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","x_google_ignoreList":[3]}